!function(t){var e={tooltip:{show:!1,cssClass:"flotTip",content:"%s | X: %x | Y: %y",xDateFormat:null,yDateFormat:null,monthNames:null,dayNames:null,shifts:{x:10,y:20},defaultTheme:!0,snap:!0,lines:!1,clickTips:!1,onHover:function(t,e){},$compat:!1}};e.tooltipOpts=e.tooltip;var i=function(t){this.tipPosition={x:0,y:0},this.init(t)};i.prototype.init=function(e){function i(t){var i={};i.x=t.pageX,i.y=t.pageY,e.setTooltipPosition(i)}function o(i,o,a){n.clickmode?(t(e.getPlaceholder()).bind("plothover",s),e.hideTooltip(),n.clickmode=!1):(s(i,o,a),n.getDomElement().is(":visible")&&(t(e.getPlaceholder()).unbind("plothover",s),n.clickmode=!0))}function s(i,o,s){var a=function(t,e,i,o){return Math.sqrt((i-t)*(i-t)+(o-e)*(o-e))},p=function(t,e,i,o,s,n,p){if(!p||(p=function(t,e,i,o,s,n){if("undefined"!=typeof i)return{x:i,y:e};if("undefined"!=typeof o)return{x:t,y:o};var a,p=-1/((n-o)/(s-i));return{x:a=(s*(t*p-e+o)+i*(t*-p+e-n))/(p*(s-i)+o-n),y:p*a-p*t+e}}(t,e,i,o,s,n),p.x>=Math.min(i,s)&&p.x<=Math.max(i,s)&&p.y>=Math.min(o,n)&&p.y<=Math.max(o,n))){var r=o-n,l=s-i,d=i*n-o*s;return Math.abs(r*t+l*e+d)/Math.sqrt(r*r+l*l)}var c=a(t,e,i,o),x=a(t,e,s,n);return c>x?x:c};if(s)e.showTooltip(s,n.tooltipOptions.snap?s:o);else if(n.plotOptions.series.lines.show&&n.tooltipOptions.lines===!0){var r=n.plotOptions.grid.mouseActiveRadius,l={distance:r+1},d=o;t.each(e.getData(),function(t,i){for(var s=0,r=-1,c=1;c<i.data.length;c++)i.data[c-1][0]<=o.x&&i.data[c][0]>=o.x&&(s=c-1,r=c);if(-1===r)return void e.hideTooltip();var x={x:i.data[s][0],y:i.data[s][1]},u={x:i.data[r][0],y:i.data[r][1]},f=p(i.xaxis.p2c(o.x),i.yaxis.p2c(o.y),i.xaxis.p2c(x.x),i.yaxis.p2c(x.y),i.xaxis.p2c(u.x),i.yaxis.p2c(u.y),!1);if(f<l.distance){var h=a(x.x,x.y,o.x,o.y)<a(o.x,o.y,u.x,u.y)?s:r,y=(i.datapoints.pointsize,[o.x,x.y+(u.y-x.y)*((o.x-x.x)/(u.x-x.x))]),m={datapoint:y,dataIndex:h,series:i,seriesIndex:t};l={distance:f,item:m},n.tooltipOptions.snap&&(d={pageX:i.xaxis.p2c(y[0]),pageY:i.yaxis.p2c(y[1])})}}),l.distance<r+1?e.showTooltip(l.item,d):e.hideTooltip()}else e.hideTooltip()}var n=this,a=t.plot.plugins.length;if(this.plotPlugins=[],a)for(var p=0;a>p;p++)this.plotPlugins.push(t.plot.plugins[p].name);e.hooks.bindEvents.push(function(e,a){if(n.plotOptions=e.getOptions(),"boolean"==typeof n.plotOptions.tooltip&&(n.plotOptions.tooltipOpts.show=n.plotOptions.tooltip,n.plotOptions.tooltip=n.plotOptions.tooltipOpts,delete n.plotOptions.tooltipOpts),n.plotOptions.tooltip.show!==!1&&"undefined"!=typeof n.plotOptions.tooltip.show){n.tooltipOptions=n.plotOptions.tooltip,n.tooltipOptions.$compat?(n.wfunc="width",n.hfunc="height"):(n.wfunc="innerWidth",n.hfunc="innerHeight");n.getDomElement();t(e.getPlaceholder()).bind("plothover",s),n.tooltipOptions.clickTips&&t(e.getPlaceholder()).bind("plotclick",o),n.clickmode=!1,t(a).bind("mousemove",i)}}),e.hooks.shutdown.push(function(e,n){t(e.getPlaceholder()).unbind("plothover",s),t(e.getPlaceholder()).unbind("plotclick",o),e.removeTooltip(),t(n).unbind("mousemove",i)}),e.setTooltipPosition=function(e){var i=n.getDomElement(),o=i.outerWidth()+n.tooltipOptions.shifts.x,s=i.outerHeight()+n.tooltipOptions.shifts.y;e.x-t(window).scrollLeft()>t(window)[n.wfunc]()-o&&(e.x-=o,e.x=Math.max(e.x,0)),e.y-t(window).scrollTop()>t(window)[n.hfunc]()-s&&(e.y-=s),isNaN(e.x)?n.tipPosition.x=n.tipPosition.xPrev:(n.tipPosition.x=e.x,n.tipPosition.xPrev=e.x),isNaN(e.y)?n.tipPosition.y=n.tipPosition.yPrev:(n.tipPosition.y=e.y,n.tipPosition.yPrev=e.y)},e.showTooltip=function(t,i,o){var s=n.getDomElement(),a=n.stringFormat(n.tooltipOptions.content,t);""!==a&&(s.html(a),e.setTooltipPosition({x:n.tipPosition.x,y:n.tipPosition.y}),s.css({left:n.tipPosition.x+n.tooltipOptions.shifts.x,top:n.tipPosition.y+n.tooltipOptions.shifts.y}).show(),"function"==typeof n.tooltipOptions.onHover&&n.tooltipOptions.onHover(t,s))},e.hideTooltip=function(){n.getDomElement().hide().html("")},e.removeTooltip=function(){n.getDomElement().remove()}},i.prototype.getDomElement=function(){var e=t("<div>");return this.tooltipOptions&&this.tooltipOptions.cssClass&&(e=t("."+this.tooltipOptions.cssClass),0===e.length&&(e=t("<div />").addClass(this.tooltipOptions.cssClass),e.appendTo("body").hide().css({position:"absolute"}),this.tooltipOptions.defaultTheme&&e.css({background:"#fff","z-index":"1040",padding:"0.4em 0.6em","border-radius":"0.5em","font-size":"0.8em",border:"1px solid #111",display:"none","white-space":"nowrap"}))),e},i.prototype.stringFormat=function(t,e){var i,o,s,n,a,p=/%p\.{0,1}(\d{0,})/,r=/%s/,l=/%c/,d=/%lx/,c=/%ly/,x=/%x\.{0,1}(\d{0,})/,u=/%y\.{0,1}(\d{0,})/,f="%x",h="%y",y="%ct",m="%n";if("undefined"!=typeof e.series.threshold?(i=e.datapoint[0],o=e.datapoint[1],s=e.datapoint[2]):"undefined"!=typeof e.series.curvedLines?(i=e.datapoint[0],o=e.datapoint[1]):"undefined"!=typeof e.series.lines&&e.series.lines.steps?(i=e.series.datapoints.points[2*e.dataIndex],o=e.series.datapoints.points[2*e.dataIndex+1],s=""):(i=e.series.data[e.dataIndex][0],o=e.series.data[e.dataIndex][1],s=e.series.data[e.dataIndex][2]),null===e.series.label&&e.series.originSeries&&(e.series.label=e.series.originSeries.label),"function"==typeof t&&(t=t(e.series.label,i,o,e)),"boolean"==typeof t&&!t)return"";if(s&&(t=t.replace(y,s)),"undefined"!=typeof e.series.percent?n=e.series.percent:"undefined"!=typeof e.series.percents&&(n=e.series.percents[e.dataIndex]),"number"==typeof n&&(t=this.adjustValPrecision(p,t,n)),e.series.hasOwnProperty("pie")&&"undefined"!=typeof e.series.data[0][1]&&(a=e.series.data[0][1]),"number"==typeof a&&(t=t.replace(m,a)),t="undefined"!=typeof e.series.label?t.replace(r,e.series.label):t.replace(r,""),t="undefined"!=typeof e.series.color?t.replace(l,e.series.color):t.replace(l,""),t=this.hasAxisLabel("xaxis",e)?t.replace(d,e.series.xaxis.options.axisLabel):t.replace(d,""),t=this.hasAxisLabel("yaxis",e)?t.replace(c,e.series.yaxis.options.axisLabel):t.replace(c,""),this.isTimeMode("xaxis",e)&&this.isXDateFormat(e)&&(t=t.replace(x,this.timestampToDate(i,this.tooltipOptions.xDateFormat,e.series.xaxis.options))),this.isTimeMode("yaxis",e)&&this.isYDateFormat(e)&&(t=t.replace(u,this.timestampToDate(o,this.tooltipOptions.yDateFormat,e.series.yaxis.options))),"number"==typeof i&&(t=this.adjustValPrecision(x,t,i)),"number"==typeof o&&(t=this.adjustValPrecision(u,t,o)),"undefined"!=typeof e.series.xaxis.ticks){var v;v=this.hasRotatedXAxisTicks(e)?"rotatedTicks":"ticks";var g=e.dataIndex+e.seriesIndex;for(var O in e.series.xaxis[v])if(e.series.xaxis[v].hasOwnProperty(g)&&!this.isTimeMode("xaxis",e)){var b=this.isCategoriesMode("xaxis",e)?e.series.xaxis[v][g].label:e.series.xaxis[v][g].v;b===i&&(t=t.replace(x,e.series.xaxis[v][g].label.replace(/\$/g,"$$$$")))}}if("undefined"!=typeof e.series.yaxis.ticks)for(var P in e.series.yaxis.ticks)if(e.series.yaxis.ticks.hasOwnProperty(P)){var T=this.isCategoriesMode("yaxis",e)?e.series.yaxis.ticks[P].label:e.series.yaxis.ticks[P].v;T===o&&(t=t.replace(u,e.series.yaxis.ticks[P].label.replace(/\$/g,"$$$$")))}return"undefined"!=typeof e.series.xaxis.tickFormatter&&(t=t.replace(f,e.series.xaxis.tickFormatter(i,e.series.xaxis).replace(/\$/g,"$$"))),"undefined"!=typeof e.series.yaxis.tickFormatter&&(t=t.replace(h,e.series.yaxis.tickFormatter(o,e.series.yaxis).replace(/\$/g,"$$"))),t},i.prototype.isTimeMode=function(t,e){return"undefined"!=typeof e.series[t].options.mode&&"time"===e.series[t].options.mode},i.prototype.isXDateFormat=function(t){return"undefined"!=typeof this.tooltipOptions.xDateFormat&&null!==this.tooltipOptions.xDateFormat},i.prototype.isYDateFormat=function(t){return"undefined"!=typeof this.tooltipOptions.yDateFormat&&null!==this.tooltipOptions.yDateFormat},i.prototype.isCategoriesMode=function(t,e){return"undefined"!=typeof e.series[t].options.mode&&"categories"===e.series[t].options.mode},i.prototype.timestampToDate=function(e,i,o){var s=t.plot.dateGenerator(e,o);return t.plot.formatDate(s,i,this.tooltipOptions.monthNames,this.tooltipOptions.dayNames)},i.prototype.adjustValPrecision=function(t,e,i){var o,s=e.match(t);return null!==s&&""!==RegExp.$1&&(o=RegExp.$1,i=i.toFixed(o),e=e.replace(t,i)),e},i.prototype.hasAxisLabel=function(e,i){return-1!==t.inArray("axisLabels",this.plotPlugins)&&"undefined"!=typeof i.series[e].options.axisLabel&&i.series[e].options.axisLabel.length>0},i.prototype.hasRotatedXAxisTicks=function(e){return-1!==t.inArray("tickRotor",this.plotPlugins)&&"undefined"!=typeof e.series.xaxis.rotatedTicks};var o=function(t){new i(t)};t.plot.plugins.push({init:o,options:e,name:"tooltip",version:"0.8.5"})}(jQuery);